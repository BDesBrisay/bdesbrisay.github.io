<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
  <meta name="theme-color" content="#0a0a0f">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  <title>BackingTracks</title>
  
  <link rel="shortcut icon apple-touch-icon" type="image/x-icon" href="./favicon.ico">
  <link rel="manifest" href="./manifest.json">
  <link rel="pwa-setup" href="./manifest.json">
  <link rel="stylesheet" href="./index.css">
  
  <script src="./pwacompat.js"></script>
</head>
<body>
  <!-- Initialization Overlay (iOS Safari requires user gesture to start audio) -->
  <div id="init-overlay" class="init-overlay">
    <div class="init-icon">ðŸŽµ</div>
    <p class="init-text">Tap to start BackingTracks</p>
    <button id="init-btn" class="init-btn">Start</button>
  </div>

  <div class="app">
    <!-- Header -->
    <header class="header">
      <span class="header-icon">ðŸŽ¸</span>
      <h1>BackingTracks</h1>
    </header>

    <!-- Transport Controls -->
    <section class="panel">
      <div class="transport">
        <button id="play-btn" class="transport-btn play" aria-label="Play">â–¶</button>
        <button id="stop-btn" class="transport-btn stop" aria-label="Stop">â– </button>
        <div class="volume-control">
          <span class="volume-icon">ðŸ”Š</span>
          <input type="range" id="volume" min="0" max="100" value="80" aria-label="Volume">
        </div>
      </div>
      
      <!-- Beat Indicator -->
      <div id="beat-indicator" class="beat-indicator">
        <div class="beat-dot" data-beat="0"></div>
        <div class="beat-dot" data-beat="1"></div>
        <div class="beat-dot" data-beat="2"></div>
        <div class="beat-dot" data-beat="3"></div>
      </div>
    </section>

    <!-- Tempo -->
    <section class="panel">
      <div class="tempo-row">
        <div class="tempo-header">
          <span class="control-label">Tempo</span>
          <span id="tempo-value" class="tempo-value">120 BPM</span>
        </div>
        <input type="range" id="tempo" min="60" max="180" value="120" aria-label="Tempo">
      </div>
    </section>

    <!-- Track Settings -->
    <section class="panel">
      <div class="control-row">
        <span class="control-label">Style</span>
        <select id="style">
          <option value="rock">Rock</option>
          <option value="pop">Pop</option>
          <option value="jazz">Jazz</option>
          <option value="funk">Funk</option>
          <option value="blues">Blues</option>
        </select>
      </div>
      
      <div class="control-row">
        <span class="control-label">Key</span>
        <select id="key">
          <option value="C">C Major</option>
          <option value="G">G Major</option>
          <option value="D">D Major</option>
          <option value="A">A Major</option>
          <option value="E">E Major</option>
          <option value="F">F Major</option>
          <option value="Bb">Bb Major</option>
          <option value="Am">A Minor</option>
          <option value="Em">E Minor</option>
          <option value="Dm">D Minor</option>
        </select>
      </div>
      
      <div class="control-row">
        <span class="control-label">Progression</span>
        <select id="progression">
          <option value="I-V-vi-IV">I - V - vi - IV</option>
          <option value="I-IV-V-I">I - IV - V - I</option>
          <option value="ii-V-I">ii - V - I</option>
          <option value="I-vi-IV-V">I - vi - IV - V</option>
          <option value="I-IV-I-V">I - IV - I - V</option>
          <option value="vi-IV-I-V">vi - IV - I - V</option>
        </select>
      </div>
      
      <div class="control-row">
        <span class="control-label">Metronome</span>
        <div id="metronome-toggle" class="toggle" role="switch" aria-checked="true">
          <div class="toggle-knob"></div>
        </div>
      </div>
    </section>

    <!-- Track Mutes -->
    <section class="panel">
      <div class="panel-header">
        <span class="panel-title">Tracks</span>
      </div>
      <div class="track-controls">
        <button id="drums-toggle" class="track-btn" data-track="drums">Drums</button>
        <button id="bass-toggle" class="track-btn" data-track="bass">Bass</button>
        <button id="chords-toggle" class="track-btn" data-track="chords">Chords</button>
      </div>
    </section>

    <!-- Recording -->
    <section class="panel">
      <div class="panel-header">
        <span class="panel-title">Recording</span>
      </div>
      <div class="record-controls">
        <button id="record-btn" class="record-btn">
          <span class="record-dot"></span>
          <span id="record-text">Record</span>
        </button>
        <button id="play-recording-btn" class="record-btn" disabled>
          â–¶ Play Recording
        </button>
      </div>
    </section>

    <!-- Track Library -->
    <section class="panel">
      <div class="panel-header">
        <span class="panel-title">Saved Recordings</span>
      </div>
      <div id="library-list" class="library-list">
        <div class="library-empty">No saved recordings yet</div>
      </div>
    </section>
  </div>

  <!-- Scripts -->
  <script type="module" src="./app.js"></script>
</body>
</html>
